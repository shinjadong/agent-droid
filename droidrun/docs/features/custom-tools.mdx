---
title: 'ì»¤ìŠ¤í…€ ë„êµ¬'
description: 'ì»¤ìŠ¤í…€ Python í•¨ìˆ˜ë¡œ Droidrun í™•ì¥í•˜ê¸°'
---

## ê°œìš”

ì»¤ìŠ¤í…€ ë„êµ¬ëŠ” ê¸°ë³¸ ì›ì ì•¡ì…˜(í´ë¦­, íƒ€ì´í•‘, ìŠ¤ì™€ì´í”„)ì„ ë„˜ì–´ ì—ì´ì „íŠ¸ ê¸°ëŠ¥ì„ í™•ì¥í•˜ëŠ” Python í•¨ìˆ˜ì…ë‹ˆë‹¤.

ğŸ“– **ì»¤ìŠ¤í…€ ë„êµ¬(Custom Tools)**
â”œâ”€ **ì •ì˜**: ì—ì´ì „íŠ¸ê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì‚¬ìš©ì ì •ì˜ Python í•¨ìˆ˜
â”œâ”€ **ì‰¬ìš´ ë¹„ìœ **: ìŠ¤ë§ˆíŠ¸í° ì•±ì— í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€í•˜ë“¯ì´ ì—ì´ì „íŠ¸ì— ìƒˆ ê¸°ëŠ¥ ì¶”ê°€
â”œâ”€ **ë©”ì»¤ë‹ˆì¦˜**: Python í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê³  ë”•ì…”ë„ˆë¦¬ë¡œ ë“±ë¡í•˜ë©´ ì—ì´ì „íŠ¸ê°€ í˜¸ì¶œ ê°€ëŠ¥
â””â”€ **ì¡´ì¬ ì´ìœ **: ì™¸ë¶€ API í˜¸ì¶œ, ë°ì´í„° ì²˜ë¦¬ ë“± ë„ë©”ì¸ë³„ ë¡œì§ êµ¬í˜„

**ì‚¬ìš© ì‚¬ë¡€:**
- ì™¸ë¶€ API í˜¸ì¶œ (ì›¹í›…, REST ì„œë¹„ìŠ¤)
- ë°ì´í„° ì²˜ë¦¬ ë° ê³„ì‚°
- ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…
- ë„ë©”ì¸ë³„ ë¡œì§

---

## ë¹ ë¥¸ ì‹œì‘

### ê¸°ë³¸ ì˜ˆì‹œ

ë””ë°”ì´ìŠ¤ ì ‘ê·¼ ì—†ëŠ” ê°„ë‹¨í•œ ì»¤ìŠ¤í…€ ë„êµ¬:

```python
import asyncio
from droidrun import DroidAgent
from droidrun.config_manager import DroidrunConfig

def calculate_tax(amount: float, rate: float, **kwargs) -> str:
    """ì£¼ì–´ì§„ ê¸ˆì•¡ì— ëŒ€í•œ ì„¸ê¸ˆ ê³„ì‚°."""
    tax = amount * rate
    total = amount + tax
    return f"ì„¸ê¸ˆ: ${tax:.2f}, í•©ê³„: ${total:.2f}"

custom_tools = {
    "calculate_tax": {
        "arguments": ["amount", "rate"],
        "description": "ì£¼ì–´ì§„ ê¸ˆì•¡ê³¼ ì„¸ìœ¨ì— ëŒ€í•œ ì„¸ê¸ˆ ê³„ì‚°",
        "function": calculate_tax
    }
}

async def main():
    config = DroidrunConfig()

    agent = DroidAgent(
        goal="$100ì— ëŒ€í•œ 8% ì„¸ìœ¨ë¡œ ì„¸ê¸ˆ ê³„ì‚°",
        config=config,
        custom_tools=custom_tools
    )

    result = await agent.run()
    print(result.success, result.reason)

asyncio.run(main())
```

---

## ë„êµ¬ êµ¬ì¡°

ëª¨ë“  ì»¤ìŠ¤í…€ ë„êµ¬ëŠ” ë‹¤ìŒ í˜•ì‹ì„ ë”°ë¦…ë‹ˆë‹¤:

```python
custom_tools = {
    "tool_name": {
        "arguments": ["arg1", "arg2"],           # íŒŒë¼ë¯¸í„° ì´ë¦„
        "description": "ë„êµ¬ ì„¤ëª…...",            # LLM í”„ë¡¬í”„íŠ¸ìš©
        "function": callable_function            # Python í•¨ìˆ˜
    }
}
```

**í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜:**
```python
def tool_name(arg1: type, arg2: type, *, tools=None, shared_state=None, **kwargs) -> str:
    """
    Args:
        arg1: íŒŒë¼ë¯¸í„°
        arg2: ë˜ ë‹¤ë¥¸ íŒŒë¼ë¯¸í„°
        tools: Tools ì¸ìŠ¤í„´ìŠ¤ (ì„ íƒì‚¬í•­, ìë™ ì£¼ì…)
        shared_state: DroidAgentState (ì„ íƒì‚¬í•­, ìë™ ì£¼ì…)
    """
    # êµ¬í˜„
    return "ê²°ê³¼"
```

**í•µì‹¬ ì‚¬í•­:**
- `"arguments"`ì—ëŠ” ì‚¬ìš©ì ì¸ìˆ˜ë§Œ ë‚˜ì—´ (`tools`ë‚˜ `shared_state` ì œì™¸)
- `tools`ì™€ `shared_state`ëŠ” í‚¤ì›Œë“œ ì¸ìˆ˜ë¡œ ìë™ ì£¼ì…
- í•˜ìœ„ í˜¸í™˜ì„±ì„ ìœ„í•´ `**kwargs` ì‚¬ìš©
- ë°˜í™˜ íƒ€ì…ì€ `str`ì´ì–´ì•¼ í•¨

---

## Tools ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš©

`tools` íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ ë””ë°”ì´ìŠ¤ ì ‘ê·¼:

```python
def screenshot_and_count(*, tools=None, shared_state=None, **kwargs) -> str:
    """ìŠ¤í¬ë¦°ìƒ·ì„ ì°ê³  UI ìš”ì†Œ ê°œìˆ˜ ì„¸ê¸°."""
    if not tools:
        return "ì˜¤ë¥˜: tools ì¸ìŠ¤í„´ìŠ¤ í•„ìš”"

    # ìŠ¤í¬ë¦°ìƒ· ì°ê¸°
    screenshot_path, screenshot_bytes = tools.take_screenshot()

    # UI ìƒíƒœ ê°€ì ¸ì˜¤ê¸°
    state = tools.get_state()
    element_count = len(state.get("ui_elements", []))

    return f"ìŠ¤í¬ë¦°ìƒ· ì €ì¥ë¨. {element_count}ê°œ UI ìš”ì†Œ ë°œê²¬"

custom_tools = {
    "screenshot_and_count": {
        "arguments": [],
        "description": "ìŠ¤í¬ë¦°ìƒ·ì„ ì°ê³  í™”ë©´ì˜ UI ìš”ì†Œ ê°œìˆ˜ ì„¸ê¸°",
        "function": screenshot_and_count
    }
}
```

**`tools`ë¥¼ í†µí•´ ì‚¬ìš© ê°€ëŠ¥:**
- `tools.take_screenshot()` - í™”ë©´ ìº¡ì²˜
- `tools.get_state()` - UI ê³„ì¸µ êµ¬ì¡° ê°€ì ¸ì˜¤ê¸°
- `tools.tap_by_index(index)` - ìš”ì†Œ íƒ­
- `tools.input_text(text, index)` - í…ìŠ¤íŠ¸ ì…ë ¥
- `tools.swipe(x1, y1, x2, y2)` - ìŠ¤ì™€ì´í”„ ì œìŠ¤ì²˜
- AdbTools/IOSToolsì˜ ëª¨ë“  ë©”ì„œë“œ

---

## ê³µìœ  ìƒíƒœ ì‚¬ìš©

`shared_state`ë¥¼ í†µí•´ ì—ì´ì „íŠ¸ ìƒíƒœ ì ‘ê·¼:

```python
def check_action_history(action_name: str, *, tools=None, shared_state=None, **kwargs) -> str:
    """íŠ¹ì • ì•¡ì…˜ì´ ìµœê·¼ì— ìˆ˜í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸."""
    if not shared_state:
        return "ì˜¤ë¥˜: shared_state í•„ìš”"

    # ìµœê·¼ ì•¡ì…˜ í™•ì¸
    recent_actions = shared_state.action_history[-5:]
    already_done = any(a.get("action") == action_name for a in recent_actions)

    if already_done:
        return f"ì•¡ì…˜ '{action_name}'ì´(ê°€) ì´ë¯¸ ìµœê·¼ì— ìˆ˜í–‰ë¨"

    # ë‹¨ê³„ ìˆ˜ í™•ì¸
    if shared_state.step_number > 10:
        return "ê²½ê³ : ì‘ì—…ì´ ë„ˆë¬´ ë§ì€ ë‹¨ê³„ë¥¼ ì‚¬ìš© ì¤‘"

    # ë©”ëª¨ë¦¬ ì ‘ê·¼
    if "skip_validation" in shared_state.memory:
        return "ë©”ëª¨ë¦¬ì— ë”°ë¼ ê²€ì¦ ê±´ë„ˆëœ€"

    return f"ì•¡ì…˜ '{action_name}'ì´(ê°€) ì•„ì§ ìˆ˜í–‰ë˜ì§€ ì•ŠìŒ"

custom_tools = {
    "check_action_history": {
        "arguments": ["action_name"],
        "description": "íŠ¹ì • ì•¡ì…˜ì´ ì—ì´ì „íŠ¸ ê¸°ë¡ì—ì„œ ìµœê·¼ ìˆ˜í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸",
        "function": check_action_history
    }
}
```

**DroidAgentState í•„ë“œ:**
- `step_number` - í˜„ì¬ ì‹¤í–‰ ë‹¨ê³„
- `action_history` - ì‹¤í–‰ëœ ì•¡ì…˜ ëª©ë¡
- `action_outcomes` - ì•¡ì…˜ë³„ ì„±ê³µ/ì‹¤íŒ¨
- `memory` - ì—ì´ì „íŠ¸ ë©”ëª¨ë¦¬ ë”•ì…”ë„ˆë¦¬
- `custom_variables` - ì‚¬ìš©ì ì œê³µ ë³€ìˆ˜
- `visited_packages` - ë°©ë¬¸í•œ ì•±
- `current_package_name` - í˜„ì¬ ì•± íŒ¨í‚¤ì§€
- `plan` - í˜„ì¬ Manager ê³„íš
- `droidrun/agent/droid/events.py`ì— ë” ë§ì€ ì •ë³´

---

## ì¼ë°˜ íŒ¨í„´

### API í†µí•©

```python
import requests

def fetch_weather(city: str, **kwargs) -> str:
    """APIì—ì„œ ë‚ ì”¨ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°."""
    try:
        # OpenWeatherMap API ì˜ˆì‹œ ì‚¬ìš©
        api_key = "your_api_key"
        url = f"https://api.openweathermap.org/data/2.5/weather?q={city}&appid={api_key}"

        response = requests.get(url, timeout=10)
        response.raise_for_status()

        data = response.json()
        temp = data["main"]["temp"] - 273.15  # ì„­ì”¨ë¡œ ë³€í™˜
        weather = data["weather"][0]["description"]

        return f"{city}ì˜ ë‚ ì”¨: {weather}, {temp:.1f}Â°C"
    except Exception as e:
        return f"ì˜¤ë¥˜: {str(e)}"

custom_tools = {
    "fetch_weather": {
        "arguments": ["city"],
        "description": "ì£¼ì–´ì§„ ë„ì‹œì˜ í˜„ì¬ ë‚ ì”¨ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°",
        "function": fetch_weather
    }
}
```

### ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬

```python
import sqlite3

def query_database(query: str, **kwargs) -> str:
    """ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬."""
    try:
        conn = sqlite3.connect("app.db")
        cursor = conn.execute(query)
        results = cursor.fetchall()
        conn.close()

        return f"{len(results)}ê°œ ê²°ê³¼ ë°œê²¬"
    except Exception as e:
        return f"ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜: {str(e)}"

custom_tools = {
    "query_database": {
        "arguments": ["query"],
        "description": "ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ SQL ì¿¼ë¦¬ ì‹¤í–‰ ë° ê²°ê³¼ ë°˜í™˜",
        "function": query_database
    }
}
```

### ë¹„ë™ê¸° ì‘ì—…

```python
import aiohttp

async def fetch_async(url: str, **kwargs) -> str:
    """ë¹„ë™ê¸°ë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°."""
    try:
        async with aiohttp.ClientSession() as session:
            async with session.get(url, timeout=10) as response:
                data = await response.text()
                return f"{url}ì—ì„œ {len(data)}ë°”ì´íŠ¸ ê°€ì ¸ì˜´"
    except Exception as e:
        return f"ì˜¤ë¥˜: {str(e)}"

custom_tools = {
    "fetch_async": {
        "arguments": ["url"],
        "description": "URLì—ì„œ ë¹„ë™ê¸°ë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°",
        "function": fetch_async
    }
}
```

---

## ëª¨ë²” ì‚¬ë¡€

### 1. ëª…í™•í•œ ì„¤ëª…
êµ¬ì²´ì ì´ê³  ëª…í™•í•œ ì„¤ëª… ì‘ì„±:

```python
# ì¢‹ìŒ
"description": "JSON ë°ì´í„° í˜ì´ë¡œë“œì™€ í•¨ê»˜ ì›¹í›… URLë¡œ POST ìš”ì²­ ì „ì†¡"

# ë‚˜ì¨
"description": "ì›¹í›… ì „ì†¡"
```

### 2. ì˜¤ë¥˜ ì²˜ë¦¬
í•­ìƒ ì˜ˆì™¸ ì²˜ë¦¬:

```python
def robust_tool(url: str, **kwargs) -> str:
    try:
        response = requests.get(url, timeout=10)
        response.raise_for_status()
        return f"ì„±ê³µ: {response.status_code}"
    except requests.Timeout:
        return "ì˜¤ë¥˜: ìš”ì²­ ì‹œê°„ ì´ˆê³¼"
    except requests.RequestException as e:
        return f"ì˜¤ë¥˜: {str(e)}"
    except Exception as e:
        return f"ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜: {str(e)}"
```

### 3. ì¸ìˆ˜ ê²€ì¦
ì²˜ë¦¬ ì „ ì…ë ¥ ê²€ì¦:

```python
def validated_tool(count: int, **kwargs) -> str:
    if not isinstance(count, int):
        return "ì˜¤ë¥˜: countëŠ” ì •ìˆ˜ì—¬ì•¼ í•¨"
    if count < 0 or count > 100:
        return "ì˜¤ë¥˜: countëŠ” 0-100ì´ì–´ì•¼ í•¨"

    return f"{count}ê°œ í•­ëª© ì²˜ë¦¬ë¨"
```

### 4. ë¡œê¹…
ë””ë²„ê¹…ì„ ìœ„í•œ Python ë¡œê¹… ì‚¬ìš©:

```python
import logging
logger = logging.getLogger("droidrun")

def logged_tool(data: str, **kwargs) -> str:
    logger.info(f"ì²˜ë¦¬ ì¤‘: {data[:50]}...")
    # ë°ì´í„° ì²˜ë¦¬
    logger.info("ì™„ë£Œ")
    return "ì„±ê³µ"
```

---

## ê³ ê¸‰ ì˜ˆì‹œ

tools ì¸ìŠ¤í„´ìŠ¤, shared state, ìê²© ì¦ëª… ê²°í•©:

```python
import requests

def send_authenticated_request(
    url: str,
    data: str,
    *,
    tools=None,
    shared_state=None,
    **kwargs
) -> str:
    """ìê²© ì¦ëª…ì„ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ëœ API ìš”ì²­ ì „ì†¡."""
    try:
        # tools ì¸ìŠ¤í„´ìŠ¤ë¥¼ í†µí•´ ìê²© ì¦ëª… ì ‘ê·¼
        if not tools or not hasattr(tools, 'credential_manager'):
            return "ì˜¤ë¥˜: Credential manager ì‚¬ìš© ë¶ˆê°€"

        api_key = tools.credential_manager.get_credential("API_KEY")

        # ë„ˆë¬´ ë§ì€ ìš”ì²­ì„ í–ˆëŠ”ì§€ í™•ì¸
        if shared_state and shared_state.step_number > 15:
            return "ì˜¤ë¥˜: API í˜¸ì¶œì´ ë„ˆë¬´ ë§ìŒ"

        # ì¸ì¦ëœ ìš”ì²­ ì „ì†¡
        headers = {"Authorization": f"Bearer {api_key}"}
        response = requests.post(url, json={"data": data}, headers=headers, timeout=10)
        response.raise_for_status()

        return f"ìš”ì²­ ì„±ê³µ: {response.status_code}"
    except Exception as e:
        return f"ì˜¤ë¥˜: {str(e)}"

custom_tools = {
    "send_authenticated_request": {
        "arguments": ["url", "data"],
        "description": "ì €ì¥ëœ ìê²© ì¦ëª…ì„ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ëœ API ìš”ì²­ ì „ì†¡",
        "function": send_authenticated_request
    }
}

# ìê²© ì¦ëª…ê³¼ í•¨ê»˜ ì‚¬ìš©
credentials = {"API_KEY": "sk-1234567890"}

agent = DroidAgent(
    goal="APIë¡œ ë°ì´í„° ì „ì†¡",
    config=config,
    custom_tools=custom_tools,
    credentials=credentials
)
```

---

## ê´€ë ¨ ë¬¸ì„œ

ê³µìœ  ìƒíƒœ ë° ì»¤ìŠ¤í…€ ë„êµ¬ í†µí•© ì´í•´ë¥¼ ìœ„í•´ [ì—ì´ì „íŠ¸ ì•„í‚¤í…ì²˜](/concepts/architecture)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
