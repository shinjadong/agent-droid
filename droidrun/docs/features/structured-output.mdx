---
title: 'êµ¬ì¡°í™”ëœ ì¶œë ¥'
description: 'Pydantic ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ë””ë°”ì´ìŠ¤ ìƒí˜¸ì‘ìš©ì—ì„œ êµ¬ì¡°í™”ëœ ë°ì´í„° ì¶”ì¶œí•˜ê¸°'
---

---

## ë¹ ë¥¸ ì‹œì‘

```python
import asyncio
from pydantic import BaseModel, Field
from droidrun import DroidAgent
from droidrun.config_manager import DroidrunConfig

# 1. ì¶œë ¥ êµ¬ì¡° ì •ì˜
class ContactInfo(BaseModel):
    """ë””ë°”ì´ìŠ¤ì˜ ì—°ë½ì²˜ ì •ë³´."""
    name: str = Field(description="ì—°ë½ì²˜ì˜ ì „ì²´ ì´ë¦„")
    phone: str = Field(description="ì „í™”ë²ˆí˜¸")
    email: str = Field(description="ì´ë©”ì¼ ì£¼ì†Œ", default="ì œê³µë˜ì§€ ì•ŠìŒ")

# 2. output_modelë¡œ ì—ì´ì „íŠ¸ ìƒì„±
async def main():
    config = DroidrunConfig()

    agent = DroidAgent(
        goal="John Smithì˜ ì—°ë½ì²˜ ì •ë³´ ì°¾ê¸°",
        config=config,
        output_model=ContactInfo,
    )

    # 3. ì‹¤í–‰í•˜ê³  êµ¬ì¡°í™”ëœ ì¶œë ¥ ì ‘ê·¼
    result = await agent.run()

    if result.success and result.structured_output:
        contact: ContactInfo = result.structured_output
        print(f"ì´ë¦„: {contact.name}")
        print(f"ì „í™”: {contact.phone}")
        print(f"ì´ë©”ì¼: {contact.email}")

asyncio.run(main())
```

ğŸ“– **êµ¬ì¡°í™”ëœ ì¶œë ¥(Structured Output)**
â”œâ”€ **ì •ì˜**: ììœ  í˜•ì‹ í…ìŠ¤íŠ¸ë¥¼ Pydantic ëª¨ë¸ë¡œ ì •ì˜ëœ êµ¬ì¡°í™”ëœ ë°ì´í„°ë¡œ ë³€í™˜
â”œâ”€ **ì‰¬ìš´ ë¹„ìœ **: ë©”ëª¨ë¥¼ ì½ê³  ì¤‘ìš” ì •ë³´ë§Œ ì–‘ì‹ì— ì •ë¦¬í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë°ì´í„° ì¶”ì¶œ
â”œâ”€ **ë©”ì»¤ë‹ˆì¦˜**: LLMì´ ìì—°ì–´ ì‘ë‹µì—ì„œ ìŠ¤í‚¤ë§ˆì— ë§ëŠ” JSON ê°ì²´ ìƒì„±
â””â”€ **ì¡´ì¬ ì´ìœ **: API í†µí•©, ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ë“±ì„ ìœ„í•œ ì¼ê´€ëœ ë°ì´í„° í˜•ì‹ í•„ìš”

---

## ì‘ë™ ë°©ì‹

### 2ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤

**1ë‹¨ê³„: ì‘ì—… ì‹¤í–‰**
- DroidAgentê°€ í•„ìš”í•œ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ë©´ì„œ ë””ë°”ì´ìŠ¤ ì•¡ì…˜ ìˆ˜í–‰
- Pydantic ìŠ¤í‚¤ë§ˆê°€ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ì— ìë™ ì£¼ì…ë¨
- ì—ì´ì „íŠ¸ê°€ ë°ì´í„°ë¥¼ í¬í•¨í•œ ìì—°ì–´ ë‹µë³€ìœ¼ë¡œ ì™„ë£Œ

**2ë‹¨ê³„: ì¶”ì¶œ (ì™„ë£Œ í›„)**
- `StructuredOutputAgent`ê°€ ìµœì¢… ë‹µë³€ í…ìŠ¤íŠ¸ ìˆ˜ì‹ 
- LLMì˜ `astructured_predict()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ë¡œ ë°ì´í„° ì¶”ì¶œ
- ìŠ¤í‚¤ë§ˆì— ëŒ€í•´ ê²€ì¦í•˜ê³  íƒ€ì…ì´ ì§€ì •ëœ ê°ì²´ ë˜ëŠ” `None` ë°˜í™˜

---

## ì˜ˆì‹œ: ì†¡ì¥ ì¶”ì¶œ

```python
from pydantic import BaseModel, Field
from typing import List

class Invoice(BaseModel):
    """ì†¡ì¥ ì •ë³´."""
    invoice_number: str = Field(description="ì†¡ì¥ ID")
    vendor_name: str = Field(description="ê³µê¸‰ì—…ì²´ ì´ë¦„")
    total_due: float = Field(description="ë‹¬ëŸ¬ ë‹¨ìœ„ ì´ ê¸ˆì•¡")

agent = DroidAgent(
    goal="Gmail ì—´ê³  Acme Corp ì´ë©”ì¼ì—ì„œ ì†¡ì¥ ì¶”ì¶œ",
    config=DroidrunConfig(),
    output_model=Invoice,
)

result = await agent.run()
invoice = result.structured_output
print(f"ì†¡ì¥ {invoice.invoice_number}: ${invoice.total_due}")
```

---

## ê²°ê³¼ ì²˜ë¦¬

### ë°ì´í„° ì ‘ê·¼

```python
result = await agent.run()

if result.success:
    if result.structured_output:
        data = result.structured_output  # íƒ€ì…ì´ ì§€ì •ëœ Pydantic ê°ì²´
        print(f"ì¶”ì¶œë¨: {data}")
    else:
        print(f"ì¶”ì¶œ ì‹¤íŒ¨, í…ìŠ¤íŠ¸ ë‹µë³€: {result.reason}")
else:
    print(f"ì‘ì—… ì‹¤íŒ¨: {result.reason}")
```

### JSONìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°

```python
result = await agent.run()

if result.structured_output:
    # JSONìœ¼ë¡œ ë³€í™˜í•˜ê³  ì €ì¥
    json_str = result.structured_output.model_dump_json(indent=2)
    with open("output.json", "w") as f:
        f.write(json_str)
```

---

## ì„¤ì •

### ì»¤ìŠ¤í…€ ì¶”ì¶œ LLM

ê¸°ë³¸ì ìœ¼ë¡œ ì¶”ì¶œì€ `codeact` LLMì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì „ìš© `structured_output` í”„ë¡œí•„ì„ ì§€ì •í•˜ì„¸ìš”:

**config.yaml:**
```yaml
llm_profiles:
  codeact:
    provider: GoogleGenAI
    model: models/gemini-2.0-flash
    temperature: 0.3

  structured_output:
    provider: OpenAI
    model: gpt-4o-mini
    temperature: 0.0  # ì¼ê´€ëœ ì¶”ì¶œì„ ìœ„í•œ ë‚®ì€ ì˜¨ë„
```

**í”„ë¡œê·¸ë˜ë° ë°©ì‹:**
```python
from droidrun import load_llm

config = DroidrunConfig()

llms = {
    "codeact": load_llm("GoogleGenAI", "models/gemini-2.0-flash"),
    "structured_output": load_llm("OpenAI", "gpt-4o-mini"),
}

agent = DroidAgent(
    goal="Aliceì˜ ì—°ë½ì²˜ ì •ë³´ ì¶”ì¶œ",
    llms=llms,
    config=config,
    output_model=ContactInfo,
)
```

### ì¶”ë¡  ëª¨ë“œ

ì§ì ‘ ë° ì¶”ë¡  ëª¨ë“œ ëª¨ë‘ì—ì„œ ì‘ë™:

```python
# ì§ì ‘ ëª¨ë“œ
config = DroidrunConfig()
config.agent.reasoning = False

agent = DroidAgent(
    goal="SFì˜ ë‚ ì”¨ ì°¾ê¸°",
    config=config,
    output_model=WeatherInfo,
)

# ì¶”ë¡  ëª¨ë“œ
config.agent.reasoning = True

agent = DroidAgent(
    goal="SFì˜ ë‚ ì”¨ ì°¾ê¸°",
    config=config,
    output_model=WeatherInfo,
)
```

---

## ëª¨ë²” ì‚¬ë¡€

**1. ëª…í™•í•œ í•„ë“œ ì„¤ëª… ì¶”ê°€** - LLMì´ ì´ê²ƒì„ ì‚¬ìš©í•˜ì—¬ ë¬´ì—‡ì„ ì¶”ì¶œí• ì§€ ì´í•´:
```python
name: str = Field(description="ì£¼ë¬¸ì„ í•œ ê³ ê°ì˜ ì „ì²´ ì´ë¦„")
```

**2. ì„ íƒì  í•„ë“œì— ê¸°ë³¸ê°’ ì œê³µ** - ì¶”ì¶œ ì‹¤íŒ¨ ë°©ì§€:
```python
rating: Optional[float] = Field(description="ê³ ê° í‰ì  (1-5)", default=None)
```

**3. ëª©í‘œì—ì„œ ë°ì´í„° ìˆ˜ì§‘ ì•ˆë‚´**:
```python
agent = DroidAgent(
    goal="ì—°ë½ì²˜ë¥¼ ì°¾ê³  ì „í™”ë²ˆí˜¸, ì´ë©”ì¼, ì „ì²´ ì´ë¦„ì„ ê°€ì ¸ì˜¤ê¸°",
    config=config,
    output_model=ContactInfo,
)
```

---

## ë¬¸ì œ í•´ê²°

**ì¶”ì¶œì´ Noneì„ ë°˜í™˜:**
- `output_model`ì´ `DroidAgent`ì— ì „ë‹¬ë˜ì—ˆëŠ”ì§€ í™•ì¸
- ì‘ì—…ì´ ì„±ê³µí–ˆëŠ”ì§€ í™•ì¸: `result.success`
- ë””ë²„ê·¸ ë¡œê¹… í™œì„±í™”: `config.logging.debug = True`

**ë¶€ë¶„ì ì´ê±°ë‚˜ ì˜ëª»ëœ ë°ì´í„°:**
- ë” êµ¬ì²´ì ì¸ í•„ë“œ ì„¤ëª… ì¶”ê°€
- ëª©í‘œì—ì„œ í•„ìˆ˜ í•„ë“œë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì–¸ê¸‰

**ê²€ì¦ ì˜¤ë¥˜:**
- ë¶ˆí™•ì‹¤í•œ í•„ë“œì— `Optional`ê³¼ ê¸°ë³¸ê°’ ì¶”ê°€

---

## ê³ ê¸‰

### ì—¬ëŸ¬ í•­ëª©

`List` í•„ë“œê°€ ìˆëŠ” ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ëª©ë¡ ì¶”ì¶œ:

```python
class ContactList(BaseModel):
    """ì—¬ëŸ¬ ì—°ë½ì²˜."""
    contacts: List[ContactInfo] = Field(description="ì—°ë½ì²˜ ëª©ë¡")

agent = DroidAgent(
    goal="John Smithì™€ Jane Doeì˜ ì—°ë½ì²˜ ì°¾ê¸°",
    config=config,
    output_model=ContactList,
)
```

### ì›Œí¬í”Œë¡œìš° í†µí•©

ì¶”ì¶œì€ `DroidAgent.finalize()`ì—ì„œ ìë™ìœ¼ë¡œ ë°œìƒ:

```python
@step
async def finalize(self, ctx: Context, ev: FinalizeEvent) -> ResultEvent:
    result = ResultEvent(
        success=ev.success,
        reason=ev.reason,
        steps=self.shared_state.step_number,
        structured_output=None,
    )

    # ëª¨ë¸ì´ ì œê³µëœ ê²½ìš° ì¶”ì¶œ
    if self.output_model is not None and ev.reason:
        structured_agent = StructuredOutputAgent(
            llm=self.structured_output_llm,
            pydantic_model=self.output_model,
            answer_text=ev.reason,
        )
        extraction_result = await (await structured_agent.run())
        if extraction_result["success"]:
            result.structured_output = extraction_result["structured_output"]

    return result
```

---

## ê´€ë ¨ ë¬¸ì„œ

- [DroidAgent API](/sdk/droid-agent)
- [Pydantic ë¬¸ì„œ](https://docs.pydantic.dev/)
- [ì„¤ì • ê°€ì´ë“œ](/sdk/configuration)
- [ì»¤ìŠ¤í…€ ë³€ìˆ˜](/features/custom-variables)
