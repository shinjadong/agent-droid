---
title: ì›Œí¬í”Œë¡œìš°
description: ë©€í‹° ì—ì´ì „íŠ¸ ì¡°ìœ¨ê³¼ ë³µì¡í•œ ì‘ì—… íë¦„ ê´€ë¦¬
---

# ì›Œí¬í”Œë¡œìš°

**ì›Œí¬í”Œë¡œìš°(Flow)** ëŠ” ì—¬ëŸ¬ ì—ì´ì „íŠ¸ë¥¼ ì¡°ìœ¨í•˜ì—¬ ë³µì¡í•œ ì‘ì—…ì„ ì²´ê³„ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

ğŸ“– **ì›Œí¬í”Œë¡œìš°**
â”œâ”€ **ì •ì˜**: ì—¬ëŸ¬ ì—ì´ì „íŠ¸ê°€ í˜‘ë ¥í•˜ì—¬ ë³µì¡í•œ ì‘ì—…ì„ ë‹¨ê³„ë³„ë¡œ ì²˜ë¦¬í•˜ëŠ” ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì‹œìŠ¤í…œ
â”œâ”€ **ì‰¬ìš´ ë¹„ìœ **: í”„ë¡œì íŠ¸ ê´€ë¦¬ìê°€ ì—¬ëŸ¬ íŒ€ì— ì‘ì—…ì„ ë‚˜ëˆ„ì–´ ë°°ë¶„í•˜ê³  ì¡°ìœ¨í•˜ëŠ” ê²ƒ
â”œâ”€ **ë©”ì»¤ë‹ˆì¦˜**: Planning Agentê°€ ì‘ì—… ë¶„í•´ â†’ ê° ì—ì´ì „íŠ¸ì— í• ë‹¹ â†’ ê²°ê³¼ í†µí•©
â””â”€ **ì¡´ì¬ ì´ìœ **: ë‹¨ì¼ ì—ì´ì „íŠ¸ë¡œ ì²˜ë¦¬í•˜ê¸° ì–´ë ¤ìš´ ëŒ€ê·œëª¨ ì‘ì—…ì„ íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜í–‰

## Flow ì•„í‚¤í…ì²˜

```
ì‚¬ìš©ì ìš”ì²­
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BaseFlow    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€ PlanningFlow    (ì‘ì—… ë¶„í•´ ë° ì¡°ìœ¨)
       â”œâ”€â”€ SequentialFlow  (ìˆœì°¨ ì‹¤í–‰)
       â””â”€â”€ ParallelFlow    (ë³‘ë ¬ ì‹¤í–‰)
```

## BaseFlow

ëª¨ë“  ì›Œí¬í”Œë¡œìš°ì˜ ê¸°ë³¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤:

```python
class BaseFlow(BaseModel, ABC):
    agents: Dict[str, BaseAgent]
    
    @abstractmethod
    async def execute(self, request: str) -> str:
        """ì›Œí¬í”Œë¡œìš° ì‹¤í–‰"""
        pass
```

## PlanningFlow

Planning Agentê°€ ì‘ì—…ì„ ë¶„í•´í•˜ê³  ì ì ˆí•œ ì—ì´ì „íŠ¸ì— í• ë‹¹í•©ë‹ˆë‹¤.

### ì‘ë™ ì›ë¦¬

```
1. ì‚¬ìš©ì ìš”ì²­ ìˆ˜ì‹ 
    â†“
2. Planning Agentê°€ ì‘ì—… ë¶„ì„ ë° ë¶„í•´
    â†“
3. ê° ì„œë¸ŒíƒœìŠ¤í¬ë¥¼ ì ì ˆí•œ ì—ì´ì „íŠ¸ì— í• ë‹¹
    â”œâ”€ ë°ì´í„° ë¶„ì„ â†’ DataAnalysis Agent
    â”œâ”€ ì›¹ ì‘ì—… â†’ Manus Agent (Browser)
    â””â”€ ì¼ë°˜ ì‘ì—… â†’ Manus Agent
    â†“
4. ê° ì—ì´ì „íŠ¸ ìˆœì°¨ ì‹¤í–‰
    â†“
5. ê²°ê³¼ í†µí•© ë° ë°˜í™˜
```

### êµ¬í˜„ ì˜ˆì‹œ

```python
class PlanningFlow(BaseFlow):
    planner: PlanningAgent
    
    async def execute(self, request: str) -> str:
        # 1. ì‘ì—… ê³„íš ìˆ˜ë¦½
        plan = await self.planner.create_plan(request)
        
        # 2. ê° ë‹¨ê³„ ì‹¤í–‰
        results = []
        for task in plan.tasks:
            agent = self.agents[task.agent_name]
            result = await agent.run(task.description)
            results.append(result)
        
        # 3. ê²°ê³¼ í†µí•©
        return await self.planner.synthesize(results)
```

### ì‚¬ìš© ì˜ˆì‹œ

```python
flow = FlowFactory.create_flow(
    flow_type=FlowType.PLANNING,
    agents={
        "manus": Manus(),
        "data_analysis": DataAnalysis()
    }
)

result = await flow.execute(
    "sales.csvë¥¼ ë¶„ì„í•˜ê³  ìƒìœ„ 10ê°œ ì œí’ˆì„ ì›¹ì—ì„œ ê²€ìƒ‰í•´ì¤˜"
)
```

## Planning Agent

ì‘ì—…ì„ ë¶„í•´í•˜ê³  ì¡°ìœ¨í•˜ëŠ” íŠ¹ìˆ˜ ì—ì´ì „íŠ¸ì…ë‹ˆë‹¤.

### í•µì‹¬ ë„êµ¬

```python
class CreatePlan(BaseTool):
    name = "create_plan"
    description = "ì‘ì—…ì„ ì„œë¸ŒíƒœìŠ¤í¬ë¡œ ë¶„í•´"
    
    async def execute(
        self,
        tasks: List[Dict],
        **kwargs
    ) -> ToolResult:
        """
        tasks: [
            {
                "description": "sales.csv íŒŒì¼ ë¶„ì„",
                "agent": "data_analysis",
                "dependencies": []
            },
            {
                "description": "ìƒìœ„ ì œí’ˆ ì›¹ ê²€ìƒ‰",
                "agent": "manus",
                "dependencies": [0]
            }
        ]
        """
```

### ì‘ì—… ê³„íš ì˜ˆì‹œ

```json
{
  "plan": {
    "tasks": [
      {
        "id": 0,
        "description": "sales.csv íŒŒì¼ì„ ì½ê³  ë§¤ì¶œ ë¶„ì„",
        "agent": "data_analysis",
        "dependencies": []
      },
      {
        "id": 1,
        "description": "ìƒìœ„ 10ê°œ ì œí’ˆ ì¶”ì¶œ",
        "agent": "data_analysis",
        "dependencies": [0]
      },
      {
        "id": 2,
        "description": "ê° ì œí’ˆì„ Googleì—ì„œ ê²€ìƒ‰",
        "agent": "manus",
        "dependencies": [1]
      }
    ]
  }
}
```

## FlowFactory

ì›Œí¬í”Œë¡œìš°ë¥¼ ìƒì„±í•˜ëŠ” íŒ©í† ë¦¬ í´ë˜ìŠ¤ì…ë‹ˆë‹¤:

```python
class FlowType(Enum):
    PLANNING = "planning"
    SEQUENTIAL = "sequential"
    PARALLEL = "parallel"

class FlowFactory:
    @staticmethod
    def create_flow(
        flow_type: FlowType,
        agents: Dict[str, BaseAgent]
    ) -> BaseFlow:
        if flow_type == FlowType.PLANNING:
            return PlanningFlow(agents=agents)
        elif flow_type == FlowType.SEQUENTIAL:
            return SequentialFlow(agents=agents)
        elif flow_type == FlowType.PARALLEL:
            return ParallelFlow(agents=agents)
```

## ì—ì´ì „íŠ¸ ì¡°í•© íŒ¨í„´

### 1. Manus + DataAnalysis

ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„:

```python
agents = {
    "manus": Manus(),           # ì›¹ì—ì„œ ë°ì´í„° ìˆ˜ì§‘
    "analysis": DataAnalysis()  # ë°ì´í„° ë¶„ì„ ë° ì‹œê°í™”
}

flow = FlowFactory.create_flow(FlowType.PLANNING, agents)
result = await flow.execute(
    "ê²½ìŸì‚¬ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ê°€ê²© ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ê³  ë¹„êµ ì°¨íŠ¸ë¥¼ ë§Œë“¤ì–´ì¤˜"
)
```

### 2. Browser + Manus

ì›¹ ìë™í™” ë° ì²˜ë¦¬:

```python
agents = {
    "browser": BrowserAgent(),  # ë¸Œë¼ìš°ì € ì œì–´
    "manus": Manus()            # ê²°ê³¼ ì²˜ë¦¬
}

flow = FlowFactory.create_flow(FlowType.PLANNING, agents)
result = await flow.execute(
    "GitHubì—ì„œ trending ì €ì¥ì†Œë¥¼ ìŠ¤í¬ë©í•˜ê³  READMEë¥¼ ìš”ì•½í•´ì¤˜"
)
```

### 3. Multiple Manus Agents

ë³‘ë ¬ ì²˜ë¦¬:

```python
agents = {
    "manus1": Manus(),
    "manus2": Manus(),
    "manus3": Manus()
}

# ë³‘ë ¬ ì‹¤í–‰
flow = FlowFactory.create_flow(FlowType.PARALLEL, agents)
result = await flow.execute([
    "task1ì„ ì²˜ë¦¬í•´ì¤˜",
    "task2ë¥¼ ì²˜ë¦¬í•´ì¤˜",
    "task3ì„ ì²˜ë¦¬í•´ì¤˜"
])
```

## ì‹¤í–‰ ëª¨ë“œ

### run_flow.py

ë©€í‹° ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰:

```bash
python run_flow.py
```

ì„¤ì •:

```toml
[runflow]
use_data_analysis_agent = true  # DataAnalysis ì—ì´ì „íŠ¸ í™œì„±í™”
```

### ì‘ì—… íë¦„

```python
async def run_flow():
    agents = {
        "manus": Manus(),
    }
    if config.run_flow_config.use_data_analysis_agent:
        agents["data_analysis"] = DataAnalysis()
    
    flow = FlowFactory.create_flow(
        flow_type=FlowType.PLANNING,
        agents=agents,
    )
    
    result = await flow.execute(user_prompt)
```

## ê³ ê¸‰ íŒ¨í„´

### ì˜ì¡´ì„± ê´€ë¦¬

ì‘ì—… ê°„ ì˜ì¡´ì„±ì„ ì •ì˜:

```python
tasks = [
    {
        "id": 0,
        "description": "ë°ì´í„° ìˆ˜ì§‘",
        "dependencies": []
    },
    {
        "id": 1,
        "description": "ë°ì´í„° ì •ì œ",
        "dependencies": [0]  # 0ë²ˆ ì‘ì—… ì™„ë£Œ í›„ ì‹¤í–‰
    },
    {
        "id": 2,
        "description": "ë¶„ì„",
        "dependencies": [1]  # 1ë²ˆ ì‘ì—… ì™„ë£Œ í›„ ì‹¤í–‰
    },
    {
        "id": 3,
        "description": "ì‹œê°í™”",
        "dependencies": [2]  # 2ë²ˆ ì‘ì—… ì™„ë£Œ í›„ ì‹¤í–‰
    }
]
```

### ì¡°ê±´ë¶€ ì‹¤í–‰

```python
class ConditionalFlow(BaseFlow):
    async def execute(self, request: str) -> str:
        # 1. ì¡°ê±´ í‰ê°€
        if await self.should_use_data_analysis(request):
            agent = self.agents["data_analysis"]
        else:
            agent = self.agents["manus"]
        
        # 2. ì„ íƒëœ ì—ì´ì „íŠ¸ ì‹¤í–‰
        return await agent.run(request)
```

### ì˜¤ë¥˜ ë³µêµ¬

```python
async def execute_with_retry(
    self,
    task: Task,
    max_retries: int = 3
) -> str:
    for attempt in range(max_retries):
        try:
            agent = self.agents[task.agent_name]
            result = await agent.run(task.description)
            return result
        except Exception as e:
            if attempt == max_retries - 1:
                raise
            logger.warning(f"ì¬ì‹œë„ {attempt + 1}/{max_retries}")
            await asyncio.sleep(2 ** attempt)
```

## ì„±ëŠ¥ ìµœì í™”

### ë³‘ë ¬ ì‹¤í–‰

ë…ë¦½ì ì¸ ì‘ì—…ì„ ë™ì‹œì— ì‹¤í–‰:

```python
async def execute_parallel(self, tasks: List[Task]) -> List[str]:
    coroutines = [
        self.agents[task.agent_name].run(task.description)
        for task in tasks
        if not task.dependencies
    ]
    
    results = await asyncio.gather(*coroutines)
    return results
```

### íƒ€ì„ì•„ì›ƒ ì„¤ì •

```python
result = await asyncio.wait_for(
    flow.execute(prompt),
    timeout=3600  # 1ì‹œê°„ íƒ€ì„ì•„ì›ƒ
)
```

## ëª¨ë²” ì‚¬ë¡€

### 1. ëª…í™•í•œ ì‘ì—… ë¶„í•´

```python
# Good
tasks = [
    "1. CSV íŒŒì¼ ì½ê¸°",
    "2. ë°ì´í„° ì •ì œ (ê²°ì¸¡ì¹˜ ì œê±°)",
    "3. ê¸°ìˆ  í†µê³„ ê³„ì‚°",
    "4. ì‹œê°í™”"
]

# Bad (ëª¨í˜¸í•¨)
tasks = [
    "ë°ì´í„° ì²˜ë¦¬"
]
```

### 2. ì ì ˆí•œ ì—ì´ì „íŠ¸ ì„ íƒ

```python
# ë°ì´í„° ë¶„ì„ì€ DataAnalysisì—ê²Œ
if "ë¶„ì„" in task or "ì°¨íŠ¸" in task:
    agent = agents["data_analysis"]
# ì›¹ ì‘ì—…ì€ Manusì—ê²Œ
elif "ê²€ìƒ‰" in task or "ì›¹" in task:
    agent = agents["manus"]
```

### 3. ê²°ê³¼ ê²€ì¦

```python
result = await agent.run(task)
if not self.is_valid_result(result):
    # ì¬ì‹œë„ ë˜ëŠ” ë‹¤ë¥¸ ì „ëµ
    result = await self.fallback_strategy(task)
```

## ë‹¤ìŒ ë‹¨ê³„

- [ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ](/concepts/agents): ê°œë³„ ì—ì´ì „íŠ¸ ì´í•´
- [Planning Agent](/guides/planning-agent): Planning Agent ìƒì„¸ ê°€ì´ë“œ
- [DataAnalysis Agent](/guides/data-analysis): ë°ì´í„° ë¶„ì„ ì—ì´ì „íŠ¸
- [API ì°¸ì¡°](/api/flows): Flow API ë¬¸ì„œ
