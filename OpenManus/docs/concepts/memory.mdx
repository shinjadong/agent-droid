---
title: ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œ
description: OpenManusì˜ ëŒ€í™” ë©”ëª¨ë¦¬ ê´€ë¦¬
---

# ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œ

ì—ì´ì „íŠ¸ì˜ **ë©”ëª¨ë¦¬**ëŠ” ëŒ€í™” íˆìŠ¤í† ë¦¬ì™€ ì‘ì—… ì»¨í…ìŠ¤íŠ¸ë¥¼ ì €ì¥í•˜ì—¬ ì¼ê´€ì„± ìˆëŠ” ì‘ë‹µì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

ğŸ“– **ë©”ëª¨ë¦¬ ì‹œìŠ¤í…œ**
â”œâ”€ **ì •ì˜**: ê³¼ê±° ëŒ€í™”ì™€ ì‘ì—… ë‚´ì—­ì„ ì €ì¥í•˜ì—¬ ë¬¸ë§¥ì„ ìœ ì§€í•˜ëŠ” ì‹œìŠ¤í…œ
â”œâ”€ **ì‰¬ìš´ ë¹„ìœ **: ëŒ€í™” ë…¸íŠ¸ì²˜ëŸ¼ ì§€ê¸ˆê¹Œì§€ì˜ ëŒ€í™” ë‚´ìš©ì„ ê¸°ë¡í•˜ì—¬ ë§¥ë½ íŒŒì•…
â”œâ”€ **ë©”ì»¤ë‹ˆì¦˜**: Message ê°ì²´ë“¤ì„ ì‹œê°„ìˆœìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸ì— ì €ì¥í•˜ê³  LLMì— ì „ë‹¬
â””â”€ **ì¡´ì¬ ì´ìœ **: ë©€í‹°í„´ ëŒ€í™”ì—ì„œ ì´ì „ ë§¥ë½ì„ ê¸°ì–µí•˜ì—¬ ì •í™•í•œ ì‘ë‹µ ìƒì„±

## Memory í´ë˜ìŠ¤

```python
class Memory(BaseModel):
    messages: List[Message] = []
    max_messages: int = 100
```

### ë©”ì‹œì§€ ì¶”ê°€

```python
def add_message(self, message: Message) -> None:
    """ë©”ì‹œì§€ ì¶”ê°€ ë° ìë™ ì •ë¦¬"""
    self.messages.append(message)
    if len(self.messages) > self.max_messages:
        self.messages = self.messages[-self.max_messages:]
```

### ìµœê·¼ ë©”ì‹œì§€ ì¡°íšŒ

```python
def get_recent_messages(self, n: int) -> List[Message]:
    """ìµœê·¼ Nê°œ ë©”ì‹œì§€ ë°˜í™˜"""
    return self.messages[-n:]
```

## Message íƒ€ì…

### User Message

ì‚¬ìš©ìì˜ ì…ë ¥:

```python
Message.user_message("í”¼ë³´ë‚˜ì¹˜ ìˆ˜ì—´ì„ ìƒì„±í•´ì¤˜")
```

### System Message

ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸:

```python
Message.system_message(
    "ë‹¹ì‹ ì€ ë„ì›€ì´ ë˜ëŠ” AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤."
)
```

### Assistant Message

LLMì˜ ì‘ë‹µ:

```python
# í…ìŠ¤íŠ¸ ì‘ë‹µ
Message.assistant_message("ë„¤, ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.")

# ë„êµ¬ í˜¸ì¶œ
Message.from_tool_calls(
    tool_calls=[...],
    content="Python ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê² ìŠµë‹ˆë‹¤."
)
```

### Tool Message

ë„êµ¬ ì‹¤í–‰ ê²°ê³¼:

```python
Message.tool_message(
    content="0 1 1 2 3 5 8 13 21 34",
    name="python_execute",
    tool_call_id="call_123"
)
```

## ëŒ€í™” íë¦„ ì˜ˆì‹œ

```python
# 1. ì‚¬ìš©ì ìš”ì²­
memory.add_message(
    Message.user_message("100ê¹Œì§€ ì†Œìˆ˜ë¥¼ ì°¾ì•„ì¤˜")
)

# 2. Assistant ë„êµ¬ í˜¸ì¶œ ê²°ì •
memory.add_message(
    Message.from_tool_calls(
        tool_calls=[{
            "id": "call_1",
            "function": {
                "name": "python_execute",
                "arguments": '{"code": "..."}'
            }
        }]
    )
)

# 3. ë„êµ¬ ì‹¤í–‰ ê²°ê³¼
memory.add_message(
    Message.tool_message(
        content="[2, 3, 5, 7, 11, 13, ...]",
        name="python_execute",
        tool_call_id="call_1"
    )
)

# 4. Assistant ìµœì¢… ì‘ë‹µ
memory.add_message(
    Message.assistant_message(
        "100ê¹Œì§€ì˜ ì†Œìˆ˜ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤: 2, 3, 5, ..."
    )
)
```

## ë©”ëª¨ë¦¬ ê´€ë¦¬ ì „ëµ

### 1. ìŠ¬ë¼ì´ë”© ìœˆë„ìš°

ìµœê·¼ Nê°œ ë©”ì‹œì§€ë§Œ ìœ ì§€:

```python
memory.max_messages = 50  # ìµœê·¼ 50ê°œ ë©”ì‹œì§€ë§Œ
```

### 2. ìš”ì•½ ì „ëµ

ì˜¤ë˜ëœ ë©”ì‹œì§€ë¥¼ ìš”ì•½í•˜ì—¬ ì••ì¶•:

```python
async def summarize_old_messages(memory: Memory, threshold: int = 20):
    if len(memory.messages) > threshold:
        old_messages = memory.messages[:threshold]
        summary = await llm.summarize(old_messages)
        
        # ìš”ì•½ìœ¼ë¡œ ëŒ€ì²´
        memory.messages = [
            Message.system_message(f"ì´ì „ ëŒ€í™” ìš”ì•½: {summary}")
        ] + memory.messages[threshold:]
```

### 3. ì¤‘ìš”ë„ ê¸°ë°˜

ì¤‘ìš”í•œ ë©”ì‹œì§€ë§Œ ìœ ì§€:

```python
def filter_important(messages: List[Message]) -> List[Message]:
    important = []
    for msg in messages:
        if is_important(msg):
            important.append(msg)
    return important
```

## ì´ë¯¸ì§€ ì§€ì›

ë©”ì‹œì§€ì— ì´ë¯¸ì§€ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
# ì´ë¯¸ì§€ì™€ í•¨ê»˜ ë©”ì‹œì§€
Message.user_message(
    "ì´ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•´ì¤˜",
    base64_image="data:image/png;base64,..."
)

# ìŠ¤í¬ë¦°ìƒ· ê²°ê³¼
Message.tool_message(
    content="ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜ ì™„ë£Œ",
    name="browser_screenshot",
    tool_call_id="call_123",
    base64_image="data:image/png;base64,..."
)
```

## ì»¨í…ìŠ¤íŠ¸ ìœˆë„ìš° ê´€ë¦¬

LLMì˜ í† í° ì œí•œì„ ê³ ë ¤í•œ ë©”ëª¨ë¦¬ ê´€ë¦¬:

```python
def trim_to_context_window(
    messages: List[Message],
    max_tokens: int = 4096
) -> List[Message]:
    total_tokens = 0
    trimmed = []
    
    # ìµœì‹  ë©”ì‹œì§€ë¶€í„° ì—­ìˆœìœ¼ë¡œ
    for msg in reversed(messages):
        msg_tokens = count_tokens(msg.content)
        if total_tokens + msg_tokens > max_tokens:
            break
        trimmed.insert(0, msg)
        total_tokens += msg_tokens
    
    return trimmed
```

## ë‹¤ìŒ ë‹¨ê³„

- [ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ](/concepts/agents): ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ì—ì´ì „íŠ¸
- [LLM í†µí•©](/guides/llm-configuration): LLM ì„¤ì •
- [API ì°¸ì¡°](/api/memory): Memory API ë¬¸ì„œ
