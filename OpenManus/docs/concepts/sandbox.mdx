# ìƒŒë“œë°•ìŠ¤ (Sandbox)

OpenManusì˜ ìƒŒë“œë°•ìŠ¤ëŠ” ì—ì´ì „íŠ¸ê°€ ìƒì„±í•œ ì½”ë“œë¥¼ ì•ˆì „í•˜ê²Œ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ê²©ë¦¬ëœ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤. Docker ì»¨í…Œì´ë„ˆ ê¸°ë°˜ì˜ ì‹¤í–‰ í™˜ê²½ìœ¼ë¡œ, í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì„ ë³´í˜¸í•˜ë©´ì„œ ì„ì˜ì˜ Python ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ê°œìš”

ìƒŒë“œë°•ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í•µì‹¬ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

- **ê²©ë¦¬ëœ ì‹¤í–‰ í™˜ê²½**: Docker ì»¨í…Œì´ë„ˆë¥¼ í†µí•œ ì™„ì „í•œ ê²©ë¦¬
- **ì•ˆì „í•œ ì½”ë“œ ì‹¤í–‰**: í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ” ì½”ë“œ ì‹¤í–‰
- **íŒ¨í‚¤ì§€ ê´€ë¦¬**: pipë¥¼ í†µí•œ ë™ì  íŒ¨í‚¤ì§€ ì„¤ì¹˜
- **íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼**: ì‘ì—… ë””ë ‰í† ë¦¬ ë‚´ íŒŒì¼ ì½ê¸°/ì“°ê¸°
- **ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼**: ì™¸ë¶€ API í˜¸ì¶œ ë° ì›¹ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼

:::info[ğŸ“– ìƒŒë“œë°•ìŠ¤ ì‹¤í–‰ í™˜ê²½]

**ì •ì˜**: ìƒŒë“œë°•ìŠ¤ëŠ” ì—ì´ì „íŠ¸ê°€ ìƒì„±í•œ ì½”ë“œë¥¼ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œê³¼ ê²©ë¦¬ëœ í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ì‹¤í–‰ í™˜ê²½ì…ë‹ˆë‹¤.

**ì‰¬ìš´ ë¹„ìœ **: 
ë†€ì´í„°ì˜ ëª¨ë˜ ë†€ì´í„°(sandbox)ì²˜ëŸ¼, ì•„ì´ë“¤ì´ ì•ˆì „í•˜ê²Œ ë†€ ìˆ˜ ìˆëŠ” ì œí•œëœ ê³µê°„ì…ë‹ˆë‹¤. ì•„ì´ë“¤ì´ ëª¨ë˜ì„±ì„ ìŒ“ê±°ë‚˜ ë¬´ë„ˆëœ¨ë ¤ë„ ë†€ì´í„° ë°–ì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ” ê²ƒì²˜ëŸ¼, ìƒŒë“œë°•ìŠ¤ ë‚´ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œëŠ” í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤.

**ë©”ì»¤ë‹ˆì¦˜**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œ                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Docker ì»¨í…Œì´ë„ˆ (ìƒŒë“œë°•ìŠ¤)    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ Python ì½”ë“œ ì‹¤í–‰       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ - ë°ì´í„° ì²˜ë¦¬          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ - íŒŒì¼ I/O            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ - íŒ¨í‚¤ì§€ ì„¤ì¹˜          â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚
â”‚  â”‚  ì œí•œëœ ë¦¬ì†ŒìŠ¤:               â”‚   â”‚
â”‚  â”‚  - CPU, ë©”ëª¨ë¦¬ ì œí•œ          â”‚   â”‚
â”‚  â”‚  - ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬             â”‚   â”‚
â”‚  â”‚  - íŒŒì¼ ì‹œìŠ¤í…œ ê²©ë¦¬          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì¡´ì¬ ì´ìœ **:
1. **ë³´ì•ˆ**: ì•…ì˜ì ì´ê±°ë‚˜ ì˜ëª»ëœ ì½”ë“œë¡œë¶€í„° í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œ ë³´í˜¸
2. **ì¬í˜„ì„±**: ì¼ê´€ëœ ì‹¤í–‰ í™˜ê²½ì„ í†µí•œ ê²°ê³¼ ì¬í˜„ ë³´ì¥
3. **ê²©ë¦¬**: ì—¬ëŸ¬ ì‘ì—… ê°„ ê°„ì„­ ë°©ì§€
4. **ì œì–´**: ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì œí•œ ë° ëª¨ë‹ˆí„°ë§

:::

## ì•„í‚¤í…ì²˜

### ìƒŒë“œë°•ìŠ¤ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OpenManus Agent                             â”‚
â”‚  â”‚                                          â”‚
â”‚  â”œâ”€ PythonExecute Tool                     â”‚
â”‚  â”‚   â””â”€ execute(code: str)                 â”‚
â”‚  â”‚        â”‚                                 â”‚
â”‚  â”‚        â–¼                                 â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   â”‚ Sandbox Manager                 â”‚   â”‚
â”‚  â”‚   â”‚  - Docker client                â”‚   â”‚
â”‚  â”‚   â”‚  - Container lifecycle          â”‚   â”‚
â”‚  â”‚   â”‚  - Code execution               â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚        â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼ Docker API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Docker Container                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Python ì‹¤í–‰ í™˜ê²½                      â”‚   â”‚
â”‚  â”‚  - Python 3.12+                      â”‚   â”‚
â”‚  â”‚  - pip (íŒ¨í‚¤ì§€ ê´€ë¦¬ì)                â”‚   â”‚
â”‚  â”‚  - ì‘ì—… ë””ë ‰í† ë¦¬ (/workspace)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  ë¦¬ì†ŒìŠ¤ ì œí•œ:                                â”‚
â”‚  - CPU: ì œí•œ ê°€ëŠ¥                           â”‚
â”‚  - Memory: ì œí•œ ê°€ëŠ¥                        â”‚
â”‚  - Network: ê²©ë¦¬/ì œí•œ ê°€ëŠ¥                   â”‚
â”‚  - Disk: ë³¼ë¥¨ ë§ˆìš´íŠ¸                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‹¤í–‰ íë¦„

```python
# 1. ì—ì´ì „íŠ¸ê°€ Python ì½”ë“œ ìƒì„±
code = """
import pandas as pd
df = pd.read_csv('data.csv')
print(df.describe())
"""

# 2. PythonExecute ë„êµ¬ê°€ ìƒŒë“œë°•ìŠ¤ì— ì½”ë“œ ì „ì†¡
result = await python_tool.execute(code=code)

# 3. ìƒŒë“œë°•ìŠ¤ ë‚´ë¶€ ì‹¤í–‰ ê³¼ì •:
#    a. í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ (pandas)
#    b. ì½”ë“œ ì‹¤í–‰
#    c. stdout/stderr ìº¡ì²˜
#    d. ê²°ê³¼ ë°˜í™˜

# 4. ì—ì´ì „íŠ¸ê°€ ê²°ê³¼ ìˆ˜ì‹  ë° ì²˜ë¦¬
print(result.output)
```

## ì„¤ì •

### ê¸°ë³¸ ì„¤ì •

ìƒŒë“œë°•ìŠ¤ëŠ” `config.yaml` ë˜ëŠ” í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•´ ì„¤ì •í•©ë‹ˆë‹¤:

```yaml
# config.yaml
sandbox:
  host: "localhost"
  port: 8080
  use_daytona: false
  daytona_target: null
```

### í™˜ê²½ ë³€ìˆ˜

```bash
# ìƒŒë“œë°•ìŠ¤ í˜¸ìŠ¤íŠ¸ ì„¤ì •
export SANDBOX_HOST=localhost

# ìƒŒë“œë°•ìŠ¤ í¬íŠ¸ ì„¤ì •
export SANDBOX_PORT=8080

# Daytona ì‚¬ìš© ì—¬ë¶€
export USE_DAYTONA=false
```

### Daytona í†µí•©

[Daytona](https://www.daytona.io/)ëŠ” ê°œë°œ í™˜ê²½ ê´€ë¦¬ í”Œë«í¼ìœ¼ë¡œ, OpenManusì™€ í†µí•©í•˜ì—¬ ë” ê°•ë ¥í•œ ìƒŒë“œë°•ìŠ¤ í™˜ê²½ì„ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```yaml
sandbox:
  use_daytona: true
  daytona_target: "my-workspace"
```

:::info[ğŸ“– Daytona í†µí•©]

**ì •ì˜**: DaytonaëŠ” í´ë¼ìš°ë“œ ê¸°ë°˜ ê°œë°œ í™˜ê²½ì„ ê´€ë¦¬í•˜ëŠ” í”Œë«í¼ìœ¼ë¡œ, OpenManus ìƒŒë“œë°•ìŠ¤ë¥¼ ë” ê°•ë ¥í•˜ê³  í™•ì¥ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.

**ì‰¬ìš´ ë¹„ìœ **:
ê¸°ë³¸ ìƒŒë“œë°•ìŠ¤ê°€ ì§‘ ì•ˆì˜ ì‘ì€ ì‘ì—… ê³µê°„ì´ë¼ë©´, Daytona í†µí•©ì€ ì „ë¬¸ ì—°êµ¬ì‹¤ì„ ë¹Œë ¤ ì“°ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤. ë” ë§ì€ ë„êµ¬, ë” í° ê³µê°„, ë” ë‚˜ì€ ì¸í”„ë¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë©”ì»¤ë‹ˆì¦˜**:
```
OpenManus Agent
    â”‚
    â”œâ”€ use_daytona: false
    â”‚   â””â”€ ë¡œì»¬ Docker ì»¨í…Œì´ë„ˆ ì‚¬ìš©
    â”‚
    â””â”€ use_daytona: true
        â””â”€ Daytona API í˜¸ì¶œ
            â””â”€ í´ë¼ìš°ë“œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤
                - ë” ê°•ë ¥í•œ ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤
                - ì˜êµ¬ì ì¸ íŒŒì¼ ì‹œìŠ¤í…œ
                - ì‚¬ì „ êµ¬ì„±ëœ í™˜ê²½
```

**ì¡´ì¬ ì´ìœ **:
1. **í™•ì¥ì„±**: ë¡œì»¬ ë¦¬ì†ŒìŠ¤ ì œì•½ ì—†ì´ ëŒ€ê·œëª¨ ì‘ì—… ì²˜ë¦¬
2. **ì˜êµ¬ì„±**: ì„¸ì…˜ ê°„ íŒŒì¼ ë° í™˜ê²½ ìœ ì§€
3. **í˜‘ì—…**: íŒ€ì› ê°„ ìƒŒë“œë°•ìŠ¤ í™˜ê²½ ê³µìœ 
4. **ê´€ë¦¬**: ì¤‘ì•™ ì§‘ì¤‘ì‹ í™˜ê²½ ê´€ë¦¬ ë° ëª¨ë‹ˆí„°ë§

:::

## ì½”ë“œ ì‹¤í–‰

### PythonExecute ë„êµ¬

ìƒŒë“œë°•ìŠ¤ì—ì„œ Python ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ì£¼ìš” ë„êµ¬ì…ë‹ˆë‹¤:

```python
from app.tool.code import PythonExecute

# ë„êµ¬ ìƒì„±
python_tool = PythonExecute(sandbox_manager=sandbox_manager)

# ê°„ë‹¨í•œ ê³„ì‚°
result = await python_tool.execute(
    code="""
x = 10
y = 20
print(f"Sum: {x + y}")
"""
)
print(result.output)  # "Sum: 30"

# ë°ì´í„° ë¶„ì„
result = await python_tool.execute(
    code="""
import pandas as pd
import numpy as np

# ë°ì´í„° ìƒì„±
data = {'A': np.random.randn(100), 'B': np.random.randn(100)}
df = pd.DataFrame(data)

# í†µê³„ ë¶„ì„
print(df.describe())
print(f"\\nCorrelation: {df['A'].corr(df['B']):.4f}")
"""
)
```

### íŒŒì¼ ì‘ì—…

ìƒŒë“œë°•ìŠ¤ ë‚´ì—ì„œ íŒŒì¼ì„ ì½ê³  ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
# íŒŒì¼ ì“°ê¸°
await python_tool.execute(
    code="""
with open('/workspace/output.txt', 'w') as f:
    f.write('Hello from sandbox!')
"""
)

# íŒŒì¼ ì½ê¸°
result = await python_tool.execute(
    code="""
with open('/workspace/output.txt', 'r') as f:
    content = f.read()
print(content)
"""
)

# CSV íŒŒì¼ ì²˜ë¦¬
await python_tool.execute(
    code="""
import pandas as pd

# ë°ì´í„° ìƒì„± ë° ì €ì¥
df = pd.DataFrame({
    'name': ['Alice', 'Bob', 'Charlie'],
    'age': [25, 30, 35],
    'score': [85, 92, 88]
})
df.to_csv('/workspace/data.csv', index=False)

# íŒŒì¼ ì½ê¸° ë° ë¶„ì„
df_loaded = pd.read_csv('/workspace/data.csv')
print(df_loaded.describe())
"""
)
```

### íŒ¨í‚¤ì§€ ì„¤ì¹˜

ìƒŒë“œë°•ìŠ¤ëŠ” í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ìë™ìœ¼ë¡œ ê°ì§€í•˜ê³  ì„¤ì¹˜í•©ë‹ˆë‹¤:

```python
# ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
result = await python_tool.execute(
    code="""
import requests
from bs4 import BeautifulSoup

# ì›¹ ìŠ¤í¬ë˜í•‘ ì˜ˆì œ
response = requests.get('https://example.com')
soup = BeautifulSoup(response.text, 'html.parser')
print(soup.title.string)
"""
)

# ë°ì´í„° ì‹œê°í™” ë¼ì´ë¸ŒëŸ¬ë¦¬
await python_tool.execute(
    code="""
import matplotlib.pyplot as plt
import numpy as np

x = np.linspace(0, 2*np.pi, 100)
y = np.sin(x)

plt.figure(figsize=(10, 6))
plt.plot(x, y)
plt.title('Sine Wave')
plt.savefig('/workspace/plot.png')
print('Plot saved to /workspace/plot.png')
"""
)
```

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ê²©ë¦¬ ìˆ˜ì¤€

ìƒŒë“œë°•ìŠ¤ëŠ” ì—¬ëŸ¬ ìˆ˜ì¤€ì˜ ê²©ë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤:

1. **í”„ë¡œì„¸ìŠ¤ ê²©ë¦¬**: Docker ì»¨í…Œì´ë„ˆë¥¼ í†µí•œ í”„ë¡œì„¸ìŠ¤ ë¶„ë¦¬
2. **íŒŒì¼ ì‹œìŠ¤í…œ ê²©ë¦¬**: ì œí•œëœ íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼
3. **ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬**: í•„ìš”ì‹œ ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ ì œí•œ ê°€ëŠ¥
4. **ë¦¬ì†ŒìŠ¤ ê²©ë¦¬**: CPU, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì œí•œ

### ì œí•œ ì‚¬í•­

ìƒŒë“œë°•ìŠ¤ ë‚´ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì œí•œì´ ìˆìŠµë‹ˆë‹¤:

```python
# âŒ í—ˆìš©ë˜ì§€ ì•ŠëŠ” ì‘ì—…ë“¤

# 1. í˜¸ìŠ¤íŠ¸ íŒŒì¼ ì‹œìŠ¤í…œ ì§ì ‘ ì ‘ê·¼
with open('/etc/passwd', 'r') as f:  # ì‹¤íŒ¨
    content = f.read()

# 2. ì‹œìŠ¤í…œ ëª…ë ¹ì–´ ì‹¤í–‰ (ì œí•œì )
import os
os.system('rm -rf /')  # ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œë§Œ ì˜í–¥

# 3. ê³¼ë„í•œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©
# (ì„¤ì •ì— ë”°ë¼ ì œí•œë¨)
big_list = [0] * (10**10)  # ë©”ëª¨ë¦¬ ì œí•œ ì´ˆê³¼ì‹œ ì‹¤íŒ¨
```

### ì•ˆì „í•œ ì‚¬ìš© íŒ¨í„´

```python
# âœ… ê¶Œì¥ë˜ëŠ” ì‚¬ìš© íŒ¨í„´

# 1. ì‘ì—… ë””ë ‰í† ë¦¬ ì‚¬ìš©
code = """
import os
os.chdir('/workspace')  # ì•ˆì „í•œ ì‘ì—… ë””ë ‰í† ë¦¬

# íŒŒì¼ ì‘ì—…
with open('data.txt', 'w') as f:
    f.write('Safe file operation')
"""

# 2. ì˜ˆì™¸ ì²˜ë¦¬
code = """
try:
    # ìœ„í—˜í•  ìˆ˜ ìˆëŠ” ì‘ì—…
    result = risky_operation()
except Exception as e:
    print(f"Error occurred: {e}")
    result = None
"""

# 3. ë¦¬ì†ŒìŠ¤ ì œí•œ í™•ì¸
code = """
import psutil

# ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
memory = psutil.virtual_memory()
print(f"Available memory: {memory.available / 1024**3:.2f} GB")

# í° ë°ì´í„° ì²˜ë¦¬ ì „ í™•ì¸
if memory.available > required_memory:
    process_large_data()
else:
    print("Insufficient memory")
"""
```

## ëª¨ë²” ì‚¬ë¡€

### 1. íš¨ìœ¨ì ì¸ ì½”ë“œ ì‹¤í–‰

```python
# âŒ ë¹„íš¨ìœ¨ì : ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰
result1 = await python_tool.execute(code="x = 10")
result2 = await python_tool.execute(code="y = 20")
result3 = await python_tool.execute(code="print(x + y)")  # ì‹¤íŒ¨: x, y ì •ì˜ ì•ˆë¨

# âœ… íš¨ìœ¨ì : í•œ ë²ˆì— ì‹¤í–‰
result = await python_tool.execute(
    code="""
x = 10
y = 20
print(x + y)
"""
)
```

### 2. ìƒíƒœ ê´€ë¦¬

```python
# ìƒŒë“œë°•ìŠ¤ëŠ” ì‹¤í–‰ ê°„ ìƒíƒœë¥¼ ìœ ì§€í•˜ì§€ ì•ŠìŒ
# í•„ìš”í•œ ê²½ìš° íŒŒì¼ë¡œ ìƒíƒœ ì €ì¥

# ì²« ë²ˆì§¸ ì‹¤í–‰
await python_tool.execute(
    code="""
import pickle

state = {'counter': 0, 'data': [1, 2, 3]}
with open('/workspace/state.pkl', 'wb') as f:
    pickle.dump(state, f)
"""
)

# ë‘ ë²ˆì§¸ ì‹¤í–‰ - ìƒíƒœ ë³µì›
result = await python_tool.execute(
    code="""
import pickle

with open('/workspace/state.pkl', 'rb') as f:
    state = pickle.load(f)

state['counter'] += 1
print(f"Counter: {state['counter']}")

# ìƒíƒœ ì €ì¥
with open('/workspace/state.pkl', 'wb') as f:
    pickle.dump(state, f)
"""
)
```

### 3. ì˜¤ë¥˜ ì²˜ë¦¬

```python
# ì—ì´ì „íŠ¸ì—ì„œ ìƒŒë“œë°•ìŠ¤ ì˜¤ë¥˜ ì²˜ë¦¬
async def safe_execute(code: str) -> ToolResult:
    try:
        result = await python_tool.execute(code=code)
        
        if result.is_error:
            # ì˜¤ë¥˜ ë¶„ì„ ë° ì¬ì‹œë„
            if "ModuleNotFoundError" in result.output:
                # íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë¬¸ì œ
                return ToolResult(
                    output="Package installation failed. Retrying...",
                    is_error=True
                )
            elif "MemoryError" in result.output:
                # ë©”ëª¨ë¦¬ ë¶€ì¡±
                return ToolResult(
                    output="Insufficient memory. Try reducing data size.",
                    is_error=True
                )
        
        return result
        
    except Exception as e:
        return ToolResult(
            output=f"Sandbox execution failed: {e}",
            is_error=True
        )
```

### 4. ì„±ëŠ¥ ìµœì í™”

```python
# ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ì‹œ ì²­í¬ ë‹¨ìœ„ ì²˜ë¦¬
code = """
import pandas as pd

# ì²­í¬ ë‹¨ìœ„ë¡œ CSV ì½ê¸°
chunk_size = 10000
chunks = []

for chunk in pd.read_csv('large_file.csv', chunksize=chunk_size):
    # ê° ì²­í¬ ì²˜ë¦¬
    processed = chunk[chunk['value'] > 0]
    chunks.append(processed)

# ê²°ê³¼ í•©ì¹˜ê¸°
result = pd.concat(chunks)
print(f"Processed {len(result)} rows")
"""

# ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ì—°ì‚°
code = """
import numpy as np

# Generator ì‚¬ìš©
def process_data():
    for i in range(1000000):
        yield i ** 2

result = sum(process_data())
print(f"Sum: {result}")
"""
```

## ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œ

#### 1. ìƒŒë“œë°•ìŠ¤ ì—°ê²° ì‹¤íŒ¨

```bash
# ë¬¸ì œ: Docker ë°ëª¬ì´ ì‹¤í–‰ ì¤‘ì´ ì•„ë‹˜
Error: Cannot connect to the Docker daemon

# í•´ê²°:
# 1. Docker ë°ëª¬ ì‹œì‘
sudo systemctl start docker

# 2. ì‚¬ìš©ìë¥¼ docker ê·¸ë£¹ì— ì¶”ê°€
sudo usermod -aG docker $USER

# 3. ì¬ë¡œê·¸ì¸ ë˜ëŠ” ê·¸ë£¹ ë³€ê²½ ì ìš©
newgrp docker
```

#### 2. í¬íŠ¸ ì¶©ëŒ

```yaml
# ë¬¸ì œ: í¬íŠ¸ê°€ ì´ë¯¸ ì‚¬ìš© ì¤‘
Error: Port 8080 is already in use

# í•´ê²°: ë‹¤ë¥¸ í¬íŠ¸ ì‚¬ìš©
sandbox:
  host: "localhost"
  port: 8081  # ë‹¤ë¥¸ í¬íŠ¸ë¡œ ë³€ê²½
```

#### 3. íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì‹¤íŒ¨

```python
# ë¬¸ì œ: íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì‹œê°„ ì´ˆê³¼
Error: Package installation timeout

# í•´ê²°: í•„ìˆ˜ íŒ¨í‚¤ì§€ë¥¼ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì— ë¯¸ë¦¬ í¬í•¨
# Dockerfileì— ì¶”ê°€:
# RUN pip install pandas numpy matplotlib seaborn scikit-learn
```

#### 4. ë©”ëª¨ë¦¬ ë¶€ì¡±

```yaml
# ë¬¸ì œ: ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ì‹œ ë©”ëª¨ë¦¬ ë¶€ì¡±
MemoryError: Unable to allocate array

# í•´ê²°: Docker ì»¨í…Œì´ë„ˆ ë©”ëª¨ë¦¬ ì œí•œ ì¦ê°€
# docker-compose.yml
services:
  sandbox:
    mem_limit: 4g  # 4GBë¡œ ì¦ê°€
```

### ë””ë²„ê¹… íŒ

```python
# 1. ìƒì„¸í•œ ì˜¤ë¥˜ ì •ë³´ ì¶œë ¥
code = """
import traceback
import sys

try:
    # ë¬¸ì œê°€ ìˆëŠ” ì½”ë“œ
    risky_operation()
except Exception as e:
    # ì „ì²´ traceback ì¶œë ¥
    print("Error occurred:", file=sys.stderr)
    traceback.print_exc()
"""

# 2. ìƒŒë“œë°•ìŠ¤ í™˜ê²½ ì •ë³´ í™•ì¸
code = """
import sys
import os
import platform

print(f"Python version: {sys.version}")
print(f"Platform: {platform.platform()}")
print(f"Working directory: {os.getcwd()}")
print(f"Environment variables: {dict(os.environ)}")
"""

# 3. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
code = """
import psutil
import time

print(f"CPU count: {psutil.cpu_count()}")
print(f"Memory: {psutil.virtual_memory().total / 1024**3:.2f} GB")
print(f"Disk: {psutil.disk_usage('/').total / 1024**3:.2f} GB")

# CPU ì‚¬ìš©ë¥  ì¸¡ì •
cpu_percent = psutil.cpu_percent(interval=1)
print(f"CPU usage: {cpu_percent}%")
"""
```

## ê³ ê¸‰ ì‚¬ìš©ë²•

### ì»¤ìŠ¤í…€ ìƒŒë“œë°•ìŠ¤ ì´ë¯¸ì§€

í”„ë¡œì íŠ¸ë³„ ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” ì»¤ìŠ¤í…€ Docker ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```dockerfile
# Dockerfile
FROM python:3.12-slim

# ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    git \
    && rm -rf /var/lib/apt/lists/*

# Python íŒ¨í‚¤ì§€ ì„¤ì¹˜
RUN pip install --no-cache-dir \
    pandas \
    numpy \
    matplotlib \
    seaborn \
    scikit-learn \
    requests \
    beautifulsoup4

# ì‘ì—… ë””ë ‰í† ë¦¬
WORKDIR /workspace

# ê¸°ë³¸ ëª…ë ¹ì–´
CMD ["python"]
```

### ìƒŒë“œë°•ìŠ¤ ëª¨ë‹ˆí„°ë§

```python
from app.sandbox import SandboxManager
import asyncio

async def monitor_sandbox():
    """ìƒŒë“œë°•ìŠ¤ ìƒíƒœ ëª¨ë‹ˆí„°ë§"""
    manager = SandboxManager()
    
    while True:
        stats = await manager.get_stats()
        print(f"""
Sandbox Statistics:
- Active containers: {stats['active_containers']}
- CPU usage: {stats['cpu_percent']}%
- Memory usage: {stats['memory_mb']} MB
- Disk usage: {stats['disk_gb']} GB
        """)
        
        await asyncio.sleep(10)  # 10ì´ˆë§ˆë‹¤ í™•ì¸
```

### ìƒŒë“œë°•ìŠ¤ ì •ë¦¬

```python
async def cleanup_sandbox():
    """ë¯¸ì‚¬ìš© ìƒŒë“œë°•ìŠ¤ ë¦¬ì†ŒìŠ¤ ì •ë¦¬"""
    manager = SandboxManager()
    
    # ì¤‘ì§€ëœ ì»¨í…Œì´ë„ˆ ì œê±°
    await manager.prune_containers()
    
    # ë¯¸ì‚¬ìš© ì´ë¯¸ì§€ ì œê±°
    await manager.prune_images()
    
    # ë¯¸ì‚¬ìš© ë³¼ë¥¨ ì œê±°
    await manager.prune_volumes()
    
    print("Sandbox cleanup completed")
```

## ë‹¤ìŒ ë‹¨ê³„

ìƒŒë“œë°•ìŠ¤ ì‹¤í–‰ í™˜ê²½ì— ëŒ€í•´ ì´í•´í–ˆë‹¤ë©´:

- [ë„êµ¬ (Tools)](./tools.mdx) - PythonExecuteë¥¼ í¬í•¨í•œ ë‹¤ì–‘í•œ ë„êµ¬ í™œìš©ë²•
- [ì—ì´ì „íŠ¸ (Agents)](./agents.mdx) - ì—ì´ì „íŠ¸ê°€ ìƒŒë“œë°•ìŠ¤ë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•
- [ì›Œí¬í”Œë¡œìš° (Flows)](./flows.mdx) - ë³µì¡í•œ ì‘ì—…ì—ì„œ ìƒŒë“œë°•ìŠ¤ í™œìš©í•˜ê¸°
